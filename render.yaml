services:
- type: web
  name: worxy
  runtime: ruby
  repo: https://github.com/1Popla/worxy
  branch: deploy-app
  plan: starter
  envVars:
  - key: SMTP_PASSWORD
    sync: false
  - key: SMTP_USER_NAME
    sync: false
  - key: GOOGLE_CLIENT_SECRET
    sync: false
  - key: GOOGLE_CLIENT_ID
    sync: false
  - key: AWS_BUCKET
    fromService:
      name: worxy
      type: web
      property: host
  - key: AWS_REGION
    sync: false
  - key: AWS_SECRET_ACCESS_KEY
    sync: false
  - key: AWS_ACCESS_KEY_ID
    sync: false
  - key: LLAMA_API_KEY
    sync: false
  - key: HUGGING_FACE_API_KEY
    sync: false
  - key: OPENAI_API_KEY
    sync: false
  - key: GOOGLE_MAPS_API_KEY
    sync: false
  - key: RAILS_MASTER_KEY
    sync: false
  - key: WEB_CONCURRENCY
    sync: false
  - key: DATABASE_URL
    fromDatabase:
      name: worxy_db
  - key: REDIS_URL
    fromService:
      name: worxy_redis
      type: redis
      property: connectionString
  region: oregon
  buildCommand: bundle install; bundle exec rake assets:precompile; bundle exec rake assets:clean
  startCommand: bundle exec puma -t 5:5 -p ${PORT:-3000} -e ${RACK_ENV:-development}
  pullRequestPreviewsEnabled: false

- type: redis
  name: worxy_redis
  plan: standard
  maxMemoryPolicy: noeviction
  region: oregon

databases:
- type: postgres
  name: worxy_db
  plan: standard
  version: 16
  region: oregon
